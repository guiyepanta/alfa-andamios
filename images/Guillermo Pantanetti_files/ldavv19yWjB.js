/*!CK:1680184936!*//*1408625671,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["xo9lM"]); }

__d("legacy:EmployeePrefs",["EmployeePrefs"],function(a,b,c,d){a.EmployeePrefs=b('EmployeePrefs');},3);
__d("FbFeedUnreadPillLoader",["Style","fbt","SubscriptionsHandler","DOM","JSXDOM","throttle","DOMDimensions","getElementPosition","UIPagelet","Event","LitestandStream","Arbiter","Run","NavigationMessage","CSS","cx","$"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=192,y,z=null,aa=false;function ba(){var ga=j.scry(q.getStreamRoot(),q.getStoriesSelector());return ga.filter(function(ha){return ha.getAttribute('data-ft');});}function ca(ga){var ha=m.getViewportDimensions().height,ia=n(ga),ja=m.getElementDimensions(ga);if(!ia.x&&!ia.y&&!ja.x&&!ja.y)return false;var ka=Math.max(ia.y,0),la=Math.min(ia.y+ja.height,ha);return (la-ka)>=ja.height*y;}function da(){if(!z)return;j.remove(z);z=null;}function ea(){if(z)return;z=k.div({className:"_2cjx"},k.div({className:"_2cjy"},k.div({className:"_26dn"}),k.div({className:"_4qj_"},"Cargando"),k.div({className:"_4qk0"})));j.prependContent(q.getStreamRoot(),z);g.set(z,'bottom','80px');u.show(z);}var fa={getStoriesOrPosInViewport:function(ga,ha){var ia=ba(),ja=[],ka=-1;for(var la=0;la<ia.length;la++){var ma=ia[la];if(ca(ma)){ja.push(ma);ka=la;}}if(ha&&ga){return [ja,ka];}else if(ha){return ka;}else if(ga){return ja;}else return;},getAllMainFeedStories:function(){return ba();},setupScrollListener:function(ga,ha){aa=false;var ia=new i(),ja=w(ga);if(ha.unread_pill_config.not_use_main_stream)ja=j.find(document,'#stream_pagelet');y=ha.unread_pill_config.proportion_ratio;var ka=l(function(){if(aa)return;var la=fa.getStoriesOrPosInViewport(true,false);if(la.length>0){var ma=la[0];ha.unread_pill_config.story_triggered=ma.getAttribute('data-should-show-pill');var na=u.hasClass(ma,"_1_hv");if(na||ha.unread_pill_config.story_triggered){if(ha.unread_pill_config.show_loading_pill)ea();ia.release();aa=true;o.loadFromEndpoint('LitestandUnseenStreamPagelet',ja,ha,{append:true,automatic:true,usePipe:true});}}},ha.unread_pill_config.check_delay);ia.addSubscriptions(p.listen(window,'scroll',ka));if(ha.unread_pill_config.enable_hotkey)ia.addSubscriptions(p.listen(window,'keydown',function(event){if(aa)return;if(event.target.tagName!='BODY')return;var la=p.getKeyCode(event);if(la===x){aa=true;if(ha.unread_pill_config.show_loading_pill)ea();ha.unread_pill_config.hotkey_triggered=true;ia.release();o.loadFromEndpoint('LitestandUnseenStreamPagelet',ja,ha,{append:true,automatic:true,usePipe:true});}}));s.onLeave(function(){ia.release();});r.subscribeOnce(t.NAVIGATION_BEGIN,function(){ia.release();});r.subscribe('FbFeedUnreadPillLoader/removeLoadingPill',function(){da();});}};e.exports=fa;},null);